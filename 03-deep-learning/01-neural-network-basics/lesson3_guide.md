# 第3课学习指南：损失函数

> 损失函数是训练的"指南针"，告诉我们预测有多"错"

---

## 核心概念速览

| 概念 | 一句话解释 |
|------|-----------|
| 标签 (Label) | 每个样本的"正确答案" |
| 损失函数 (Loss) | 衡量预测和真实的差距 |
| MSE | 均方误差，(预测-真实)² 的平均 |
| 交叉熵 | 分类任务常用的损失函数 |

---

## 常见问题解答

### Q1: 什么是"标签"？

**标签 = 正确答案**

之前我们只有输入（水果特征），现在加上正确答案：

```
训练数据 = (输入特征, 标签)

完美草莓 = ([0.9, 0.3, 0.95], 1)   <- 1表示好吃
烂苹果   = ([0.5, 0.4, 0.1],  0)   <- 0表示不好吃
```

有了标签，才能判断网络预测得"对不对"。

---

### Q2: 为什么需要损失函数？

**问题**：网络预测了 0.65，真实答案是 1，这个预测"好不好"？

**损失函数的作用**：把"好不好"变成一个**数字**

```
损失 = 0      完美预测
损失 = 0.1    还不错
损失 = 0.5    比较差
损失 = 1.0    完全错误
```

有了数字，才能比较、才能优化。

---

### Q3: MSE 是怎么计算的？

**MSE = Mean Squared Error = 均方误差**

```
步骤1：计算每个样本的误差
    误差 = (预测 - 真实)²

步骤2：求平均
    MSE = 所有误差的平均值
```

**为什么要平方？**
- 消除正负（预测高了是正，低了是负）
- 放大大误差的影响（错得越多，惩罚越重）

**例子**：
```
草莓：预测0.66，真实1 → (0.66-1)² = 0.116
柠檬：预测0.64，真实0 → (0.64-0)² = 0.410

MSE = (0.116 + 0.410) / 2 = 0.263
```

---

### Q4: 损失和权重有什么关系？

**权重决定了网络的预测，预测决定了损失**

```
权重 → 预测结果 → 损失值
  ↑                  |
  └──── 调整 ────────┘
```

**训练的目标**：找到让损失最小的权重

| 权重 | 损失 | 评价 |
|------|------|------|
| 随机初始化 | 0.35 | 差 |
| 调整后 | 0.15 | 好一点 |
| 继续调整 | 0.05 | 很好 |
| 最优权重 | 0.01 | 接近完美 |

---

### Q5: 交叉熵和 MSE 有什么区别？

| 损失函数 | 适用场景 | 特点 |
|---------|---------|------|
| MSE | 回归问题（预测连续值）| 简单直观 |
| 交叉熵 | 分类问题（预测类别）| 梯度更好，训练更快 |

**简单理解**：
- 预测房价 → 用 MSE
- 预测猫/狗 → 用交叉熵
- 预测好吃/不好吃 → 用交叉熵更好

---

## 本课的位置

```
第1课：神经元（计算单元）
    ↓
第2课：多层网络（网络结构）
    ↓
第3课：损失函数（评估预测）  ← 你在这里
    ↓
第4课：反向传播（自动调整权重）
```

**到目前为止**：
- 我们能搭建网络 ✓
- 我们能计算预测 ✓
- 我们能评估好坏 ✓

**还差一步**：
- 怎么自动调整权重？→ 第4课

---

## 动手实验建议

1. **打开交互网页**，拖动权重滑块
2. **观察损失变化**，找到让损失最小的组合
3. **点击"随机权重"**，看看损失会变多大
4. **思考**：手动调整很累对吧？这就是为什么需要"自动优化"

---

## 关键公式

```python
# MSE 损失函数
def mse_loss(predictions, labels):
    total = 0
    for pred, label in zip(predictions, labels):
        error = (pred - label) ** 2
        total += error
    return total / len(predictions)
```

---

## 学习检查

完成本课后，你应该能回答：

- [ ] 什么是标签？为什么需要标签？
- [ ] 损失函数的作用是什么？
- [ ] MSE 是怎么计算的？
- [ ] 损失值越大代表什么？越小代表什么？
- [ ] 训练的目标是什么？

---

<p align="center"><b>损失函数告诉我们"错了多少"，下一课学习"怎么改正"！</b></p>
