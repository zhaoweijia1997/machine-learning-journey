<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>ç¬¬2è¯¾ï¼šå¤šå±‚ç¥ç»ç½‘ç»œ - äº¤äº’å¼æ¼”ç¤º</title>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: 'Segoe UI', 'Microsoft YaHei', sans-serif;
            background: linear-gradient(135deg, #1a1a2e 0%, #16213e 100%);
            min-height: 100vh;
            color: #fff;
            padding: 20px;
        }

        .container {
            max-width: 1200px;
            margin: 0 auto;
        }

        h1 {
            text-align: center;
            margin-bottom: 10px;
            font-size: 2em;
            background: linear-gradient(90deg, #00d9ff, #00ff88);
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
        }

        .subtitle {
            text-align: center;
            color: #888;
            margin-bottom: 30px;
        }

        .main-content {
            display: grid;
            grid-template-columns: 280px 1fr 200px;
            gap: 20px;
        }

        .panel {
            background: rgba(255, 255, 255, 0.05);
            border-radius: 15px;
            padding: 20px;
            border: 1px solid rgba(255, 255, 255, 0.1);
        }

        .panel h2 {
            font-size: 1.1em;
            margin-bottom: 15px;
            color: #00d9ff;
            display: flex;
            align-items: center;
            gap: 8px;
        }

        /* è¾“å…¥æ§åˆ¶ */
        .input-group {
            margin-bottom: 20px;
        }

        .input-group label {
            display: block;
            margin-bottom: 8px;
            font-size: 0.9em;
        }

        .slider-container {
            display: flex;
            align-items: center;
            gap: 10px;
        }

        input[type="range"] {
            flex: 1;
            height: 6px;
            border-radius: 3px;
            background: #333;
            outline: none;
            -webkit-appearance: none;
        }

        input[type="range"]::-webkit-slider-thumb {
            -webkit-appearance: none;
            width: 18px;
            height: 18px;
            border-radius: 50%;
            background: #00d9ff;
            cursor: pointer;
        }

        .value-display {
            min-width: 45px;
            text-align: right;
            font-family: monospace;
            color: #00ff88;
        }

        /* ç¥ç»ç½‘ç»œå¯è§†åŒ– */
        .network-viz {
            display: flex;
            flex-direction: column;
            align-items: center;
        }

        #networkCanvas {
            background: rgba(0, 0, 0, 0.3);
            border-radius: 10px;
            border: 1px solid rgba(255, 255, 255, 0.1);
        }

        /* è¾“å‡ºé¢æ¿ */
        .output-panel .result {
            text-align: center;
            padding: 20px;
            background: rgba(0, 0, 0, 0.3);
            border-radius: 10px;
            margin-bottom: 15px;
        }

        .result-score {
            font-size: 2.5em;
            font-weight: bold;
            margin: 10px 0;
        }

        .result-label {
            font-size: 1.2em;
            padding: 8px 16px;
            border-radius: 20px;
            display: inline-block;
            margin-top: 10px;
        }

        .result-good {
            background: linear-gradient(90deg, #00ff88, #00d9ff);
            color: #000;
        }

        .result-ok {
            background: linear-gradient(90deg, #ffaa00, #ff6600);
            color: #000;
        }

        .result-bad {
            background: linear-gradient(90deg, #ff4444, #cc0000);
            color: #fff;
        }

        /* éšè—å±‚è¯¦æƒ… */
        .hidden-details {
            margin-top: 15px;
        }

        .hidden-neuron {
            display: flex;
            align-items: center;
            margin-bottom: 8px;
            font-size: 0.85em;
        }

        .neuron-bar {
            flex: 1;
            height: 20px;
            background: #333;
            border-radius: 10px;
            margin-left: 10px;
            overflow: hidden;
        }

        .neuron-fill {
            height: 100%;
            border-radius: 10px;
            transition: width 0.3s;
        }

        /* é¢„è®¾æ°´æœ */
        .presets {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 10px;
            margin-top: 20px;
        }

        .preset-btn {
            padding: 12px 8px;
            border: none;
            border-radius: 10px;
            cursor: pointer;
            font-size: 0.85em;
            transition: all 0.3s;
            background: rgba(255, 255, 255, 0.1);
            color: #fff;
            text-align: center;
        }

        .preset-btn:hover {
            background: rgba(0, 217, 255, 0.3);
            transform: translateY(-2px);
        }

        .preset-btn .emoji {
            font-size: 1.5em;
            display: block;
            margin-bottom: 5px;
        }

        /* è¯´æ˜åŒº */
        .explanation {
            margin-top: 30px;
            padding: 20px;
            background: rgba(255, 255, 255, 0.05);
            border-radius: 15px;
            border: 1px solid rgba(255, 255, 255, 0.1);
        }

        .explanation h3 {
            color: #00d9ff;
            margin-bottom: 15px;
        }

        .explanation p {
            line-height: 1.8;
            color: #ccc;
            margin-bottom: 10px;
        }

        .formula {
            background: rgba(0, 0, 0, 0.3);
            padding: 15px;
            border-radius: 8px;
            font-family: monospace;
            margin: 15px 0;
            overflow-x: auto;
        }

        /* å±‚æ ‡ç­¾ */
        .layer-labels {
            display: flex;
            justify-content: space-around;
            margin-top: 10px;
            font-size: 0.85em;
            color: #888;
        }

        @media (max-width: 900px) {
            .main-content {
                grid-template-columns: 1fr;
            }
        }
    </style>
</head>
<body>
    <div class="container">
        <h1>ğŸ§  ç¬¬2è¯¾ï¼šå¤šå±‚ç¥ç»ç½‘ç»œ</h1>
        <p class="subtitle">åˆ¤æ–­æ°´æœå¥½ä¸å¥½åƒ - ç†è§£éšè—å±‚çš„ä½œç”¨</p>

        <div class="main-content">
            <!-- å·¦ä¾§ï¼šè¾“å…¥æ§åˆ¶ -->
            <div class="panel">
                <h2>ğŸ è¾“å…¥ç‰¹å¾</h2>

                <div class="input-group">
                    <label>ğŸ¯ ç”œåº¦</label>
                    <div class="slider-container">
                        <input type="range" id="sweetness" min="0" max="100" value="80">
                        <span class="value-display" id="sweetnessValue">0.80</span>
                    </div>
                </div>

                <div class="input-group">
                    <label>ğŸ‹ é…¸åº¦</label>
                    <div class="slider-container">
                        <input type="range" id="sourness" min="0" max="100" value="30">
                        <span class="value-display" id="sournessValue">0.30</span>
                    </div>
                </div>

                <div class="input-group">
                    <label>âœ¨ æ–°é²œåº¦</label>
                    <div class="slider-container">
                        <input type="range" id="freshness" min="0" max="100" value="90">
                        <span class="value-display" id="freshnessValue">0.90</span>
                    </div>
                </div>

                <h2 style="margin-top: 25px;">ğŸ‡ é¢„è®¾æ°´æœ</h2>
                <div class="presets">
                    <button class="preset-btn" onclick="setPreset(0.9, 0.3, 0.95)">
                        <span class="emoji">ğŸ“</span>
                        å®Œç¾è‰è“
                    </button>
                    <button class="preset-btn" onclick="setPreset(0.2, 0.95, 0.8)">
                        <span class="emoji">ğŸ‹</span>
                        é…¸æŸ æª¬
                    </button>
                    <button class="preset-btn" onclick="setPreset(0.5, 0.4, 0.1)">
                        <span class="emoji">ğŸ</span>
                        çƒ‚è‹¹æœ
                    </button>
                    <button class="preset-btn" onclick="setPreset(0.85, 0.5, 0.7)">
                        <span class="emoji">ğŸŠ</span>
                        ç”œæ©™å­
                    </button>
                </div>
            </div>

            <!-- ä¸­é—´ï¼šç½‘ç»œå¯è§†åŒ– -->
            <div class="panel network-viz">
                <h2>ğŸ”— ç¥ç»ç½‘ç»œç»“æ„</h2>
                <canvas id="networkCanvas" width="600" height="400"></canvas>
                <div class="layer-labels">
                    <span>è¾“å…¥å±‚ (3)</span>
                    <span>éšè—å±‚ (4)</span>
                    <span>è¾“å‡ºå±‚ (1)</span>
                </div>
            </div>

            <!-- å³ä¾§ï¼šè¾“å‡º -->
            <div class="panel output-panel">
                <h2>ğŸ“Š åˆ¤æ–­ç»“æœ</h2>

                <div class="result">
                    <div>å¥½åƒç¨‹åº¦</div>
                    <div class="result-score" id="outputScore">75%</div>
                    <div class="result-label result-good" id="outputLabel">å¥½åƒï¼</div>
                </div>

                <h2>ğŸ” éšè—å±‚è¾“å‡º</h2>
                <div class="hidden-details" id="hiddenDetails">
                    <!-- åŠ¨æ€ç”Ÿæˆ -->
                </div>
            </div>
        </div>

        <!-- è¯´æ˜åŒº -->
        <div class="explanation">
            <h3>ğŸ’¡ ä¸ºä»€ä¹ˆéœ€è¦éšè—å±‚ï¼Ÿ</h3>
            <p>
                <strong>å•ä¸ªç¥ç»å…ƒçš„å±€é™ï¼š</strong>åªèƒ½å­¦ä¹ "çº¿æ€§"å…³ç³»ï¼Œæ¯”å¦‚"è¶Šç”œè¶Šå¥½"ã€‚
            </p>
            <p>
                <strong>ç°å®é—®é¢˜çš„å¤æ‚æ€§ï¼š</strong>"é…¸åº¦é€‚ä¸­æœ€å¥½"æ˜¯éçº¿æ€§å…³ç³»â€”â€”å¤ªé…¸ä¸å¥½ï¼Œä¸é…¸ä¹Ÿä¸å¥½ï¼Œé€‚ä¸­æœ€å¥½ã€‚
            </p>
            <p>
                <strong>éšè—å±‚çš„ä½œç”¨ï¼š</strong>æ¯ä¸ªéšè—ç¥ç»å…ƒå­¦ä¹ ä¸€ç§"ç‰¹å¾ç»„åˆ"ï¼Œå¤šä¸ªç¥ç»å…ƒåä½œå°±èƒ½å¤„ç†å¤æ‚çš„éçº¿æ€§é—®é¢˜ï¼
            </p>

            <div class="formula">
éšè—å±‚: H = sigmoid(è¾“å…¥ Ã— Wâ‚ + bâ‚)  â†’  4ä¸ªç¥ç»å…ƒå„è‡ªè®¡ç®—<br>
è¾“å‡ºå±‚: O = sigmoid(H Ã— Wâ‚‚ + bâ‚‚)     â†’  ç»¼åˆ4ä¸ªç»“æœå¾—å‡ºæœ€ç»ˆåˆ¤æ–­
            </div>

            <p>
                <strong>è§‚å¯Ÿå®éªŒï¼š</strong>è°ƒæ•´é…¸åº¦ä»0åˆ°1ï¼Œçœ‹éšè—å±‚å„ç¥ç»å…ƒçš„å˜åŒ–ã€‚
                ä½ ä¼šå‘ç°å®ƒä»¬å¯¹é…¸åº¦çš„ååº”å„ä¸ç›¸åŒâ€”â€”æœ‰çš„å–œæ¬¢é…¸ï¼Œæœ‰çš„è®¨åŒé…¸ï¼Œç»„åˆèµ·æ¥å°±èƒ½è¡¨è¾¾"é€‚ä¸­æœ€å¥½"ï¼
            </p>
        </div>
    </div>

    <script>
        // ç¥ç»ç½‘ç»œå‚æ•°ï¼ˆä¸ Python ä»£ç ä¸€è‡´ï¼‰
        const W1 = [
            [0.8, -0.5, 0.3, 0.6],
            [0.2, 0.9, -0.7, 0.1],
            [0.5, 0.3, 0.8, 0.4]
        ];
        const b1 = [-0.3, -0.4, 0.1, -0.2];
        const W2 = [0.6, 0.4, 0.5, 0.3];
        const b2 = -0.5;

        // Sigmoid å‡½æ•°
        function sigmoid(x) {
            return 1 / (1 + Math.exp(-x));
        }

        // å‰å‘ä¼ æ’­
        function forward(inputs) {
            // éšè—å±‚
            const hidden = [];
            for (let j = 0; j < 4; j++) {
                let sum = b1[j];
                for (let i = 0; i < 3; i++) {
                    sum += inputs[i] * W1[i][j];
                }
                hidden.push(sigmoid(sum));
            }

            // è¾“å‡ºå±‚
            let outputSum = b2;
            for (let j = 0; j < 4; j++) {
                outputSum += hidden[j] * W2[j];
            }
            const output = sigmoid(outputSum);

            return { hidden, output };
        }

        // è·å–è¾“å…¥å€¼
        function getInputs() {
            return [
                document.getElementById('sweetness').value / 100,
                document.getElementById('sourness').value / 100,
                document.getElementById('freshness').value / 100
            ];
        }

        // æ›´æ–°æ˜¾ç¤º
        function update() {
            const inputs = getInputs();

            // æ›´æ–°è¾“å…¥å€¼æ˜¾ç¤º
            document.getElementById('sweetnessValue').textContent = inputs[0].toFixed(2);
            document.getElementById('sournessValue').textContent = inputs[1].toFixed(2);
            document.getElementById('freshnessValue').textContent = inputs[2].toFixed(2);

            // å‰å‘ä¼ æ’­
            const { hidden, output } = forward(inputs);

            // æ›´æ–°è¾“å‡ºæ˜¾ç¤º
            const scorePercent = Math.round(output * 100);
            document.getElementById('outputScore').textContent = scorePercent + '%';

            const labelEl = document.getElementById('outputLabel');
            if (output > 0.7) {
                labelEl.textContent = 'å¥½åƒï¼ğŸ“';
                labelEl.className = 'result-label result-good';
            } else if (output > 0.4) {
                labelEl.textContent = 'ä¸€èˆ¬èˆ¬';
                labelEl.className = 'result-label result-ok';
            } else {
                labelEl.textContent = 'ä¸å¥½åƒ ğŸ˜•';
                labelEl.className = 'result-label result-bad';
            }

            // æ›´æ–°éšè—å±‚è¯¦æƒ…
            const hiddenHTML = hidden.map((h, i) => {
                const percent = Math.round(h * 100);
                const hue = h * 120; // 0=çº¢, 120=ç»¿
                return `
                    <div class="hidden-neuron">
                        <span>H${i + 1}</span>
                        <div class="neuron-bar">
                            <div class="neuron-fill" style="width: ${percent}%; background: hsl(${hue}, 70%, 50%)"></div>
                        </div>
                        <span style="min-width: 40px; text-align: right">${percent}%</span>
                    </div>
                `;
            }).join('');
            document.getElementById('hiddenDetails').innerHTML = hiddenHTML;

            // ç»˜åˆ¶ç½‘ç»œ
            drawNetwork(inputs, hidden, output);
        }

        // ç»˜åˆ¶ç¥ç»ç½‘ç»œ
        function drawNetwork(inputs, hidden, output) {
            const canvas = document.getElementById('networkCanvas');
            const ctx = canvas.getContext('2d');

            ctx.clearRect(0, 0, canvas.width, canvas.height);

            const layerX = [100, 300, 500];
            const inputY = [100, 200, 300];
            const hiddenY = [80, 160, 240, 320];
            const outputY = [200];

            // ç»˜åˆ¶è¿æ¥çº¿
            ctx.lineWidth = 1;

            // è¾“å…¥ â†’ éšè—
            for (let i = 0; i < 3; i++) {
                for (let j = 0; j < 4; j++) {
                    const weight = W1[i][j];
                    const alpha = Math.abs(weight) * 0.5 + 0.1;
                    ctx.strokeStyle = weight > 0
                        ? `rgba(0, 255, 136, ${alpha})`
                        : `rgba(255, 100, 100, ${alpha})`;
                    ctx.beginPath();
                    ctx.moveTo(layerX[0] + 25, inputY[i]);
                    ctx.lineTo(layerX[1] - 25, hiddenY[j]);
                    ctx.stroke();
                }
            }

            // éšè— â†’ è¾“å‡º
            for (let j = 0; j < 4; j++) {
                const weight = W2[j];
                const alpha = Math.abs(weight) * 0.5 + 0.2;
                ctx.strokeStyle = `rgba(0, 217, 255, ${alpha})`;
                ctx.lineWidth = hidden[j] * 3 + 1;
                ctx.beginPath();
                ctx.moveTo(layerX[1] + 25, hiddenY[j]);
                ctx.lineTo(layerX[2] - 25, outputY[0]);
                ctx.stroke();
            }

            // ç»˜åˆ¶èŠ‚ç‚¹
            const inputLabels = ['ç”œåº¦', 'é…¸åº¦', 'æ–°é²œ'];

            // è¾“å…¥å±‚
            for (let i = 0; i < 3; i++) {
                const brightness = inputs[i];
                drawNode(ctx, layerX[0], inputY[i], 25, brightness, '#00d9ff');
                ctx.fillStyle = '#fff';
                ctx.font = '12px Microsoft YaHei';
                ctx.textAlign = 'center';
                ctx.fillText(inputLabels[i], layerX[0], inputY[i] + 45);
                ctx.fillText(inputs[i].toFixed(2), layerX[0], inputY[i] + 5);
            }

            // éšè—å±‚
            for (let j = 0; j < 4; j++) {
                drawNode(ctx, layerX[1], hiddenY[j], 25, hidden[j], '#00ff88');
                ctx.fillStyle = '#fff';
                ctx.font = '11px monospace';
                ctx.textAlign = 'center';
                ctx.fillText(hidden[j].toFixed(2), layerX[1], hiddenY[j] + 5);
            }

            // è¾“å‡ºå±‚
            drawNode(ctx, layerX[2], outputY[0], 35, output, '#ffaa00');
            ctx.fillStyle = '#fff';
            ctx.font = 'bold 14px monospace';
            ctx.textAlign = 'center';
            ctx.fillText(Math.round(output * 100) + '%', layerX[2], outputY[0] + 5);
        }

        function drawNode(ctx, x, y, r, value, color) {
            // å¤–åœˆ
            ctx.beginPath();
            ctx.arc(x, y, r, 0, Math.PI * 2);
            ctx.fillStyle = `rgba(0, 0, 0, 0.5)`;
            ctx.fill();
            ctx.strokeStyle = color;
            ctx.lineWidth = 2;
            ctx.stroke();

            // å†…åœˆï¼ˆæ ¹æ®æ¿€æ´»å€¼å¡«å……ï¼‰
            const innerR = r * 0.7 * value + r * 0.2;
            ctx.beginPath();
            ctx.arc(x, y, innerR, 0, Math.PI * 2);
            ctx.fillStyle = color;
            ctx.globalAlpha = 0.3 + value * 0.7;
            ctx.fill();
            ctx.globalAlpha = 1;
        }

        // é¢„è®¾æ°´æœ
        function setPreset(sweetness, sourness, freshness) {
            document.getElementById('sweetness').value = sweetness * 100;
            document.getElementById('sourness').value = sourness * 100;
            document.getElementById('freshness').value = freshness * 100;
            update();
        }

        // äº‹ä»¶ç›‘å¬
        ['sweetness', 'sourness', 'freshness'].forEach(id => {
            document.getElementById(id).addEventListener('input', update);
        });

        // åˆå§‹åŒ–
        update();
    </script>
</body>
</html>
