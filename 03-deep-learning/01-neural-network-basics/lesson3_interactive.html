<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>ç¬¬3è¯¾ï¼šæŸå¤±å‡½æ•° - äº¤äº’å¼æ¼”ç¤º</title>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: 'Segoe UI', 'Microsoft YaHei', sans-serif;
            background: linear-gradient(135deg, #1a1a2e 0%, #16213e 100%);
            min-height: 100vh;
            color: #fff;
            padding: 20px;
        }

        .container {
            max-width: 1100px;
            margin: 0 auto;
        }

        h1 {
            text-align: center;
            margin-bottom: 10px;
            font-size: 2em;
            background: linear-gradient(90deg, #ff6b6b, #ffd93d);
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
        }

        .subtitle {
            text-align: center;
            color: #888;
            margin-bottom: 30px;
        }

        .main-grid {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 20px;
        }

        .panel {
            background: rgba(255, 255, 255, 0.05);
            border-radius: 15px;
            padding: 20px;
            border: 1px solid rgba(255, 255, 255, 0.1);
        }

        .panel h2 {
            font-size: 1.1em;
            margin-bottom: 15px;
            color: #ffd93d;
        }

        /* æ•°æ®è¡¨æ ¼ */
        .data-table {
            width: 100%;
            border-collapse: collapse;
            font-size: 0.9em;
        }

        .data-table th, .data-table td {
            padding: 10px 8px;
            text-align: center;
            border-bottom: 1px solid rgba(255,255,255,0.1);
        }

        .data-table th {
            color: #ffd93d;
            font-weight: normal;
        }

        .label-good {
            color: #00ff88;
        }

        .label-bad {
            color: #ff6b6b;
        }

        .pred-cell {
            font-family: monospace;
        }

        .error-cell {
            font-family: monospace;
            color: #ff9f43;
        }

        .check-ok {
            color: #00ff88;
        }

        .check-wrong {
            color: #ff6b6b;
        }

        /* æŸå¤±æ˜¾ç¤º */
        .loss-display {
            text-align: center;
            padding: 30px;
            background: rgba(0, 0, 0, 0.3);
            border-radius: 15px;
            margin-bottom: 20px;
        }

        .loss-value {
            font-size: 3em;
            font-weight: bold;
            font-family: monospace;
            margin: 15px 0;
        }

        .loss-good {
            color: #00ff88;
        }

        .loss-medium {
            color: #ffd93d;
        }

        .loss-bad {
            color: #ff6b6b;
        }

        .loss-bar {
            height: 20px;
            background: #333;
            border-radius: 10px;
            overflow: hidden;
            margin-top: 15px;
        }

        .loss-fill {
            height: 100%;
            border-radius: 10px;
            transition: width 0.5s, background 0.5s;
        }

        /* æƒé‡æ§åˆ¶ */
        .weight-controls {
            margin-top: 20px;
        }

        .weight-group {
            margin-bottom: 15px;
        }

        .weight-group label {
            display: block;
            margin-bottom: 5px;
            font-size: 0.85em;
            color: #aaa;
        }

        .slider-row {
            display: flex;
            align-items: center;
            gap: 10px;
        }

        input[type="range"] {
            flex: 1;
            height: 6px;
            border-radius: 3px;
            background: #333;
            outline: none;
            -webkit-appearance: none;
        }

        input[type="range"]::-webkit-slider-thumb {
            -webkit-appearance: none;
            width: 16px;
            height: 16px;
            border-radius: 50%;
            background: #ffd93d;
            cursor: pointer;
        }

        .weight-value {
            min-width: 50px;
            text-align: right;
            font-family: monospace;
            color: #ffd93d;
        }

        /* æŒ‰é’® */
        .btn-group {
            display: flex;
            gap: 10px;
            margin-top: 20px;
        }

        .btn {
            flex: 1;
            padding: 12px;
            border: none;
            border-radius: 8px;
            cursor: pointer;
            font-size: 0.9em;
            transition: all 0.3s;
        }

        .btn-random {
            background: #ff6b6b;
            color: #fff;
        }

        .btn-better {
            background: #00ff88;
            color: #000;
        }

        .btn:hover {
            transform: translateY(-2px);
            opacity: 0.9;
        }

        /* å…¬å¼å±•ç¤º */
        .formula-box {
            background: rgba(0, 0, 0, 0.3);
            padding: 15px;
            border-radius: 10px;
            margin-top: 15px;
            font-family: monospace;
            font-size: 0.9em;
            line-height: 1.8;
        }

        /* è¯´æ˜åŒº */
        .explanation {
            grid-column: 1 / -1;
            margin-top: 20px;
        }

        .explanation h3 {
            color: #ffd93d;
            margin-bottom: 15px;
        }

        .explanation p {
            line-height: 1.8;
            color: #ccc;
            margin-bottom: 10px;
        }

        .key-point {
            background: rgba(255, 217, 61, 0.1);
            border-left: 3px solid #ffd93d;
            padding: 15px;
            margin: 15px 0;
        }

        /* å¯è§†åŒ–å¯¹æ¯” */
        .comparison {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 15px;
            margin-top: 15px;
        }

        .compare-item {
            background: rgba(0,0,0,0.2);
            padding: 15px;
            border-radius: 10px;
            text-align: center;
        }

        .compare-item h4 {
            margin-bottom: 10px;
            font-size: 0.9em;
        }

        .compare-loss {
            font-size: 1.8em;
            font-family: monospace;
            font-weight: bold;
        }

        @media (max-width: 768px) {
            .main-grid {
                grid-template-columns: 1fr;
            }
        }
    </style>
</head>
<body>
    <div class="container">
        <h1>ğŸ“‰ ç¬¬3è¯¾ï¼šæŸå¤±å‡½æ•°</h1>
        <p class="subtitle">è¡¡é‡é¢„æµ‹æœ‰å¤š"é”™" - è®­ç»ƒçš„æŒ‡å—é’ˆ</p>

        <div class="main-grid">
            <!-- å·¦ä¾§ï¼šæ•°æ®å’Œé¢„æµ‹ -->
            <div class="panel">
                <h2>ğŸ“Š è®­ç»ƒæ•°æ®ä¸é¢„æµ‹</h2>
                <table class="data-table">
                    <thead>
                        <tr>
                            <th>æ°´æœ</th>
                            <th>çœŸå®æ ‡ç­¾</th>
                            <th>ç½‘ç»œé¢„æµ‹</th>
                            <th>è¯¯å·®Â²</th>
                            <th>åˆ¤æ–­</th>
                        </tr>
                    </thead>
                    <tbody id="dataTable">
                        <!-- åŠ¨æ€ç”Ÿæˆ -->
                    </tbody>
                </table>

                <div class="formula-box">
                    <strong>MSE å…¬å¼ï¼š</strong><br>
                    Loss = (1/n) Ã— Î£(é¢„æµ‹ - çœŸå®)Â²<br><br>
                    <span id="lossCalculation"></span>
                </div>
            </div>

            <!-- å³ä¾§ï¼šæŸå¤±æ˜¾ç¤º -->
            <div class="panel">
                <h2>ğŸ“‰ æ€»æŸå¤± (MSE)</h2>
                <div class="loss-display">
                    <div>æŸå¤±å€¼</div>
                    <div class="loss-value" id="lossValue">0.1234</div>
                    <div id="lossComment">æŸå¤±è¶Šå°è¶Šå¥½</div>
                    <div class="loss-bar">
                        <div class="loss-fill" id="lossFill"></div>
                    </div>
                </div>

                <h2>ğŸ›ï¸ è°ƒæ•´è¾“å‡ºå±‚æƒé‡</h2>
                <div class="weight-controls" id="weightControls">
                    <!-- åŠ¨æ€ç”Ÿæˆ -->
                </div>

                <div class="btn-group">
                    <button class="btn btn-random" onclick="randomWeights()">ğŸ² éšæœºæƒé‡</button>
                    <button class="btn btn-better" onclick="betterWeights()">âœ¨ ä¼˜åŒ–æƒé‡</button>
                </div>
            </div>

            <!-- å¯¹æ¯”å±•ç¤º -->
            <div class="panel explanation">
                <h3>ğŸ’¡ ç†è§£æŸå¤±å‡½æ•°</h3>

                <div class="comparison">
                    <div class="compare-item">
                        <h4>ğŸ¯ ç†æƒ³æƒ…å†µ</h4>
                        <div class="compare-loss loss-good">0.0000</div>
                        <p style="font-size:0.85em; margin-top:10px; color:#888;">
                            é¢„æµ‹å®Œå…¨æ­£ç¡®<br>æ¯ä¸ªæ ·æœ¬è¯¯å·®ä¸º0
                        </p>
                    </div>
                    <div class="compare-item">
                        <h4>âŒ æœ€å·®æƒ…å†µ</h4>
                        <div class="compare-loss loss-bad">1.0000</div>
                        <p style="font-size:0.85em; margin-top:10px; color:#888;">
                            é¢„æµ‹å®Œå…¨ç›¸å<br>å¥½åƒçš„è¯´ä¸å¥½åƒ
                        </p>
                    </div>
                </div>

                <div class="key-point">
                    <strong>æ ¸å¿ƒæ€æƒ³ï¼š</strong><br>
                    æŸå¤±å‡½æ•°æ˜¯è®­ç»ƒçš„"æŒ‡å—é’ˆ"ã€‚å®ƒå‘Šè¯‰æˆ‘ä»¬å½“å‰æƒé‡çš„å¥½åã€‚<br>
                    è®­ç»ƒçš„ç›®æ ‡ = è°ƒæ•´æƒé‡ï¼Œè®©æŸå¤±å°½å¯èƒ½å°ã€‚
                </div>

                <p>
                    <strong>è¯•è¯•çœ‹ï¼š</strong>æ‹–åŠ¨ä¸Šæ–¹çš„æƒé‡æ»‘å—ï¼Œè§‚å¯ŸæŸå¤±å€¼çš„å˜åŒ–ã€‚
                    ä½ èƒ½æ‰¾åˆ°è®©æŸå¤±æœ€å°çš„æƒé‡ç»„åˆå—ï¼Ÿ
                </p>
                <p>
                    <strong>æ€è€ƒï¼š</strong>æ‰‹åŠ¨è°ƒæ•´å¾ˆéº»çƒ¦å¯¹å§ï¼Ÿä¸‹ä¸€è¯¾ä¼šå­¦ä¹ "æ¢¯åº¦ä¸‹é™"â€”â€”
                    è®©è®¡ç®—æœºè‡ªåŠ¨æ‰¾åˆ°æœ€ä¼˜æƒé‡ï¼
                </p>
            </div>
        </div>
    </div>

    <script>
        // è®­ç»ƒæ•°æ®
        const trainingData = [
            { name: 'ğŸ“ å®Œç¾è‰è“', features: [0.9, 0.3, 0.95], label: 1 },
            { name: 'ğŸŠ ç”œæ©™å­', features: [0.85, 0.5, 0.7], label: 1 },
            { name: 'ğŸ‹ é…¸æŸ æª¬', features: [0.2, 0.95, 0.8], label: 0 },
            { name: 'ğŸ çƒ‚è‹¹æœ', features: [0.5, 0.4, 0.1], label: 0 },
        ];

        // ç½‘ç»œå‚æ•°ï¼ˆéšè—å±‚å›ºå®šï¼Œåªè°ƒæ•´è¾“å‡ºå±‚ï¼‰
        const W1 = [
            [0.8, -0.5, 0.3, 0.6],
            [0.2, 0.9, -0.7, 0.1],
            [0.5, 0.3, 0.8, 0.4]
        ];
        const b1 = [-0.3, -0.4, 0.1, -0.2];

        // è¾“å‡ºå±‚æƒé‡ï¼ˆå¯è°ƒæ•´ï¼‰
        let W2 = [0.6, 0.4, 0.5, 0.3];
        let b2 = -0.5;

        function sigmoid(x) {
            return 1 / (1 + Math.exp(-x));
        }

        function forward(features) {
            // éšè—å±‚
            const hidden = [];
            for (let j = 0; j < 4; j++) {
                let sum = b1[j];
                for (let i = 0; i < 3; i++) {
                    sum += features[i] * W1[i][j];
                }
                hidden.push(sigmoid(sum));
            }
            // è¾“å‡ºå±‚
            let outputSum = b2;
            for (let j = 0; j < 4; j++) {
                outputSum += hidden[j] * W2[j];
            }
            return sigmoid(outputSum);
        }

        function calculateMSE() {
            let total = 0;
            for (const data of trainingData) {
                const pred = forward(data.features);
                const error = Math.pow(pred - data.label, 2);
                total += error;
            }
            return total / trainingData.length;
        }

        function updateDisplay() {
            // æ›´æ–°æ•°æ®è¡¨æ ¼
            const tbody = document.getElementById('dataTable');
            let html = '';
            let lossCalc = '';
            let totalError = 0;

            for (const data of trainingData) {
                const pred = forward(data.features);
                const error = Math.pow(pred - data.label, 2);
                totalError += error;

                const predLabel = pred > 0.5 ? 1 : 0;
                const correct = predLabel === data.label;

                html += `
                    <tr>
                        <td>${data.name}</td>
                        <td class="${data.label ? 'label-good' : 'label-bad'}">
                            ${data.label} (${data.label ? 'å¥½åƒ' : 'ä¸å¥½åƒ'})
                        </td>
                        <td class="pred-cell">${(pred * 100).toFixed(1)}%</td>
                        <td class="error-cell">${error.toFixed(4)}</td>
                        <td class="${correct ? 'check-ok' : 'check-wrong'}">
                            ${correct ? 'âœ“' : 'âœ—'}
                        </td>
                    </tr>
                `;

                lossCalc += `(${pred.toFixed(3)} - ${data.label})Â² = ${error.toFixed(4)}<br>`;
            }

            tbody.innerHTML = html;

            const mse = totalError / trainingData.length;
            lossCalc += `<br><strong>å¹³å‡ = ${mse.toFixed(4)}</strong>`;
            document.getElementById('lossCalculation').innerHTML = lossCalc;

            // æ›´æ–°æŸå¤±æ˜¾ç¤º
            document.getElementById('lossValue').textContent = mse.toFixed(4);

            const lossPercent = Math.min(mse * 100, 100);
            const fill = document.getElementById('lossFill');
            fill.style.width = lossPercent + '%';

            const valueEl = document.getElementById('lossValue');
            const comment = document.getElementById('lossComment');

            if (mse < 0.05) {
                valueEl.className = 'loss-value loss-good';
                fill.style.background = '#00ff88';
                comment.textContent = 'å¤ªæ£’äº†ï¼é¢„æµ‹éå¸¸å‡†ç¡®ï¼';
            } else if (mse < 0.15) {
                valueEl.className = 'loss-value loss-medium';
                fill.style.background = '#ffd93d';
                comment.textContent = 'è¿˜ä¸é”™ï¼Œç»§ç»­ä¼˜åŒ–';
            } else {
                valueEl.className = 'loss-value loss-bad';
                fill.style.background = '#ff6b6b';
                comment.textContent = 'æŸå¤±è¾ƒå¤§ï¼Œéœ€è¦è°ƒæ•´æƒé‡';
            }
        }

        function createWeightControls() {
            const container = document.getElementById('weightControls');
            let html = '';

            for (let i = 0; i < 4; i++) {
                html += `
                    <div class="weight-group">
                        <label>W2[${i}] - éšè—ç¥ç»å…ƒ${i+1}çš„æƒé‡</label>
                        <div class="slider-row">
                            <input type="range" id="w2_${i}" min="-2" max="2" step="0.1"
                                   value="${W2[i]}" onchange="updateWeight(${i}, this.value)">
                            <span class="weight-value" id="w2v_${i}">${W2[i].toFixed(1)}</span>
                        </div>
                    </div>
                `;
            }

            html += `
                <div class="weight-group">
                    <label>b2 - è¾“å‡ºå±‚åç½®</label>
                    <div class="slider-row">
                        <input type="range" id="b2" min="-2" max="2" step="0.1"
                               value="${b2}" onchange="updateBias(this.value)">
                        <span class="weight-value" id="b2v">${b2.toFixed(1)}</span>
                    </div>
                </div>
            `;

            container.innerHTML = html;
        }

        function updateWeight(index, value) {
            W2[index] = parseFloat(value);
            document.getElementById(`w2v_${index}`).textContent = parseFloat(value).toFixed(1);
            updateDisplay();
        }

        function updateBias(value) {
            b2 = parseFloat(value);
            document.getElementById('b2v').textContent = parseFloat(value).toFixed(1);
            updateDisplay();
        }

        function randomWeights() {
            for (let i = 0; i < 4; i++) {
                W2[i] = (Math.random() - 0.5) * 2;
                document.getElementById(`w2_${i}`).value = W2[i];
                document.getElementById(`w2v_${i}`).textContent = W2[i].toFixed(1);
            }
            b2 = (Math.random() - 0.5) * 2;
            document.getElementById('b2').value = b2;
            document.getElementById('b2v').textContent = b2.toFixed(1);
            updateDisplay();
        }

        function betterWeights() {
            // ä¸€ç»„é¢„è®¾çš„è¾ƒå¥½æƒé‡
            W2 = [1.5, -0.8, 1.2, 0.9];
            b2 = -1.2;

            for (let i = 0; i < 4; i++) {
                document.getElementById(`w2_${i}`).value = W2[i];
                document.getElementById(`w2v_${i}`).textContent = W2[i].toFixed(1);
            }
            document.getElementById('b2').value = b2;
            document.getElementById('b2v').textContent = b2.toFixed(1);
            updateDisplay();
        }

        // åˆå§‹åŒ–
        createWeightControls();
        updateDisplay();
    </script>
</body>
</html>
